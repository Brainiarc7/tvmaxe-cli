#!/bin/bash
cd $HOME/'.'tvmaxe-cli
source config
./ceas &
gui () {
test_tty=`echo $DISPLAY X|awk '{print $2}'`
if [[ "$test_tty" = "X" ]];then
  if [ `builtin type -p xdialog` ];then DIALOG=xdialog
  elif [ `builtin type -p Xdialog` ];then DIALOG=Xdialog
  elif [ `builtin type -p gdialog` ];then DIALOG=gdialog
  elif [ `builtin type -p kdialog` ];then DIALOG=kdialog
  else
  DIALOG=dialog
  fi
else
  DIALOG=dialog
fi
}
nogui () {
DIALOG=dialog
}
mkdir -p /tmp/tvmaxe-cli
touch /tmp/tvmaxe-cli/adr
$interfata
export DIALOG
tempfile=`tempfile 2>/dev/null` || tempfile=/tmp/tvmaxe-cli/capclitmp$$
export tempfile
trap "rm -f $tempfile" 0 1 2 5 15
trap "rm -rf /tmp/tvmaxe-cli" 0 1 2 5 15
if [[ "$1" != "" ]]; then
echo "tvmaxe-cli $1" > /tmp/tvmaxe-cli/adr
echo $format_video tv > /tmp/tvmaxe-cli/format
./adr_externa
fi

until [ "$selectie0" == "1" ]; do

  $DIALOG --backtitle "tvmaxe-cli" \
	  --title "| Meniu |" --clear \
          --menu ":::" 25 30 25 \
	"01" "TV on-line" \
	"02" "Radio on-line" \
	"03" "Shoutcast" \
	"04" "Filme" \
	"05" "Youtube" \
	"06" "Divertisment" \
	"07" "Favorite" \
	"08" "Captura web_tv" \
	"09" "Configurare" \
	"10" "Actualizare" \
	"11" "Parasiti" 2>$tempfile
  selectie0=$?
  selectat=`cat $tempfile`
  
  case "$selectat" in
	01) echo $format_video tv > /tmp/tvmaxe-cli/format    ; ./TV_online;;
	02) echo $format_audio radio > /tmp/tvmaxe-cli/format ; ./radio_online;;
	03) echo $format_audio radio > /tmp/tvmaxe-cli/format ; ./shoutcast;;
	04) ./filme;;
	05) echo "Youtube" > /tmp/tvmaxe-cli/adr ; ./youtube;;
	06) echo "Divertisment" > /tmp/tvmaxe-cli/adr ; ./divertisment;;
	07) ./favorite;;
	08) ./capstream;;
	09) ./configurare;;
	10) ./actualizare;;
	11) killall ceas
		stty sane
		exit 0
			;;
  esac

  if [ "$selectie0" == "255" ]||[ "$selectie0" == "1" ]; then
   killall ceas
	stty sane
   exit 0
  fi
done

